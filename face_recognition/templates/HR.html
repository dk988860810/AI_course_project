<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>火災預警系統</title>
  <link rel="icon" href="{{ url_for('static', filename='image/logo.png') }}">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/HR.css') }}">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">


  <style>
    a:hover {
        color: white !important;
    }

    .modal-backdrop {
        position: static;
        top: 0;
        left: 0;
    }
    .modal-backdrop {
    display: none !important;
    }
</style>
</head>
<body>
<header>
  <div class="header-content">
    <img src="{{ url_for('static', filename='image/logo.png') }}" alt="Logo" class="logo">
    <span class="system-name">員工資料</span>
    <nav>
      <div class="nav-buttons">
        <form onsubmit="executeRoute(event)">
        </form>
        
            <!-- The Modal -->
            <div class="modal fade" id="myModal">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title">Features Extraction</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
        
                        <!-- Modal Body -->
                        <div class="modal-body">
                            <!-- Modal 內容 -->
                            <p>特征提取成功</p>
                        </div>
        
                        <!-- Modal Footer -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        </div>
        
                    </div>
                </div>
            </div>
        
            <!-- <a href="/face_recognition"><button class="status-btn face" >Face recognizer</button></a> -->
        
        <a href="/user_form" class="status-btn face">出缺勤狀況</a>
        <a href="/get_face" class="status-btn face">臉部註冊</a>
        <a href="{{ url_for('login') }}" class="logout-link">
          <button class="logout-button">Log out</button>
        </a>
      </div>
    </nav>
  </div>
</header>

  <main>
    <div class="search-container">
      <input type="text" id="searchInput" class="search-input" placeholder="搜尋員工...">
      <button id="searchBtn" class="search-btn"><i class="material-icons">search</i></button>
      <button id="addEmployeeBtn" class="add-employee-btn">新增員工</button>

    <!-- 在這裡加入 Bootstrap 彈窗的按鈕 -->
<!--    <a href="/features_extraction"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Features Extraction</button></a>-->
<!--    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Features Extraction</button>-->

<!--    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Features Extraction</button>-->
    </div>    

    <div class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>工號</th>
            <th>姓名</th>
            <th>職務名稱</th>
            <th>所屬組別</th>
            <th>辦公位置</th>
            <th>聯絡電話</th>
            <th>緊急聯絡人</th>
            <th>緊急聯絡人電話</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
          {% for row in rows %}
          <tr>
            <td>{{ row['工號'] }}</td>
            <td>{{ row['姓名'] }}</td>
            <td>{{ row['職務名稱'] }}</td>
            <td>{{ row['所屬組別'] }}</td>
            <td>{{ row['辦公位置'] }}</td>
            <td>{{ row['聯絡電話'] }}</td>
            <td>{{ row['緊急聯絡人'] }}</td>
            <td>{{ row['緊急聯絡人電話'] }}</td>
            <td>
              <button class="edit-btn" data-toggle="modal" data-target="#editModal" data-id="{{ row['工號'] }}">編輯</button>
              <form action="/delete/{{ row['工號'] }}" method="post" style="display:inline;">
                <button type="submit" class="delete-btn">刪除</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="pagination-container">
      <div class="pagination">
        {% if page > 1 %}
          <a href="{{ url_for('profile', page=page - 1) }}">上一頁</a>
        {% endif %}
        <span class="page-info">{{ page }} / {{ total_pages }}</span>
        {% if page < total_pages %}
          <a href="{{ url_for('profile', page=page + 1) }}">下一頁</a>
        {% endif %}
      </div>
    </div>
  </main>

  <!-- 新增員工彈出視窗 -->
  <div id="addEmployeeModal" class="modal">
    <div class="modal-content">
      <!-- <span id="cancelAddEmployee_2" class="close">&times;</span> -->
      <h2>新增員工</h2>
<form id="addEmployeeForm" action="/add_employee" method="post" enctype="multipart/form-data">
    <label for="job_id">工號:</label>
    <input type="text" id="job_id" name="job_id" required>

    <label for="name">姓名:</label>
    <input type="text" id="name" name="name" required>

    <label for="jobTitle">職務:</label>
    <input type="text" id="jobTitle" name="jobTitle" required>

    <label for="department">部門:</label>
    <input type="text" id="department" name="department" required>

    <label for="location">辦公位置:</label>
    <input type="text" id="location" name="location" required>

    <label for="phone">聯絡電話:</label>
    <input type="tel" id="phone" name="phone" required>

    <label for="emergencyContact">緊急聯絡人:</label>
    <input type="text" id="emergencyContact" name="emergencyContact" required>

    <label for="personalFiles">緊急聯絡人電話:</label>
    <input type="text" id="personalFiles" name="personalFiles" required>

    <button type="submit">新增</button>
    <button type="button" id="cancelAddEmployee">取消</button>
</form>
    </div>
  </div>


<!-- 編輯員工彈出視窗 -->
<div id="editModal" class="modal edit-employee-modal">
  <div class="modal-content edit-employee-modal-content">
    <div class="modal-header">
      <h5 class="modal-title">編輯員工資料</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form id="editEmployeeForm">
        <input type="hidden" id="editId" name="id">
        <div class="form-group">
          <label for="editName">姓名:</label>
          <input type="text" id="editName" name="name" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="editJobTitle">職務:</label>
          <input type="text" id="editJobTitle" name="jobTitle" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="editDepartment">部門:</label>
          <input type="text" id="editDepartment" name="department" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="editLocation">辦公位置:</label>
          <input type="text" id="editLocation" name="location" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="editPhone">聯絡電話:</label>
          <input type="tel" id="editPhone" name="phone" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="editEmergencyContact">緊急聯絡人:</label>
          <input type="text" id="editEmergencyContact" name="emergencyContact" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="editEmergencyPhone">緊急聯絡人電話:</label>
          <input type="tel" id="editEmergencyPhone" name="emergencyPhone" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary">保存</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
      </form>
    </div>
  </div>
</div>


  <footer>
    © 2024 火災預警系統
  </footer>




  <script src="{{ url_for('static', filename='js/HR.js') }}"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="{{ url_for('static', filename='js/index.js') }}"></script>

  <script>
    $(document).ready(function() {
      // Edit button click
      $('.edit-btn').on('click', function() {
        var row = $(this).closest('tr');
        var id = row.find('td:eq(0)').text();
        var name = row.find('td:eq(1)').text();
        var jobTitle = row.find('td:eq(2)').text();
        var department = row.find('td:eq(3)').text();
        var location = row.find('td:eq(4)').text();
        var phone = row.find('td:eq(5)').text();
        var emergencyContact = row.find('td:eq(6)').text();
        var emergencyPhone = row.find('td:eq(7)').text();
    
        $('#editId').val(id);
        $('#editName').val(name);
        $('#editJobTitle').val(jobTitle);
        $('#editDepartment').val(department);
        $('#editLocation').val(location);
        $('#editPhone').val(phone);
        $('#editEmergencyContact').val(emergencyContact);
        $('#editEmergencyPhone').val(emergencyPhone);
      });
    
      // Edit form submit
      $('#editEmployeeForm').on('submit', function(e) {
        e.preventDefault();
        var formData = $(this).serialize();
        $.post('/edit', formData, function(response) {
          if (response.success) {
            location.reload();
          } else {
            alert(response.message);
          }
        });
      });
    });
    </script>

</body>
</html>
